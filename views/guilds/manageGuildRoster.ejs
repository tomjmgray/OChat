<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head') %>
    <title>Document</title>
</head>
<body>
    <%- include('../partials/header') %>
    <main>
        <h1>Manage <%= guild.name %></h1>
        <div class="form">
            <h1>Guild Invite Requests</h1>
            <div class="login container">
                
                <ul class="form">
                    <% if (guild.joinRequests.length !== 0) { %>
                        <% for (let i = 0; i < guild.joinRequests.length; i++) { %>
                            <li>
                                <form action="/guilds/addMember" method="POST">
                                    <input type="hidden" value="<%= guild._id %>" name="guildId">
                                    <input type="hidden" id="name" name="name" value="<%= guild.joinRequests[i]._id %>">
                                    <label for="name"><%= guild.joinRequests[i].name %></label>
                                    <br>
                                    <label for="isOfficer">Add as Officer?</label>
                                    <input type="checkbox" name="isOfficer" id="isOfficer">
                                    <button type="submit">Accept Request</button>
                                </form>
                                <form action="/guilds/declineJoinRequest" method="POST">
                                    <input type="hidden" name="userId" value="<%=guild.joinRequests[i]._id%>">
                                    <input type="hidden" name="guildId" value="<%= guild._id %>">
                                    <button type="submit">Decline Request</button>
                                </form> 
                            </li>
                    <% } %>
                    <% } else { %>
                        <li>You have no new join requests.</li>
                    <% } %>
                    
                </ul>
            </div>
            <div class="form">
                <h1>Manage Members</h1>
                <div class="register container">
                    
                    <div class="form">
                        <h3 class="party-leader">Officers</h3>
                        <ul class="form">
                            <li class="raid-warning">Guild Master: <%= guild.guildMaster.name %></li>
                            <% guild.officers.forEach(officer => { %>
                                <div class="form">
                                    <li class="party-leader"><%= officer.name %>
                                <% if (officer.user.isAdmin[0]?.toString() === guild._id.toString()) { %>
                                    <button><a href="/characters/removeAdmin/<%= officer._id %>">Remove Admin</a></button>
                                <% } else { %>
                                    <button><a href="/characters/grantAdmin/<%= officer._id %>">Make Admin</a></button>
                                <% } %>
                                
                                <button><a href="/characters/demoteCharacter/<%= officer._id %>">Demote</a></button>
                                <button><a href="/characters/gkickOfficer/<%= officer._id %>">GKick</a></button>
                            <% }) %>
                                </li>
                                </div>
                                
                        </ul>
                    </div>
                    <div class="form">
                            <h3>Members</h3>
                            <ul class="form">
                                <% guild.members.forEach(member => { %>
                                    <li class="<%= member.class %>"><%= member.name %>
                                    <button><a href="/characters/gkickMember/<%= member._id %>">GKick</a></button>
                                    </li>
                                <% }) %>
                            </ul>
                    </div>
                </div>
            </div>
            
        </div>
        
        
    </main>
    
    
    
</body>
</html>